# 规划资源行业文档分类、加工方案与算子配置全案

## 1. 概述

本方案整合了规划资源行业的文档分类体系、加工处理方案和算子配置规范，旨在为规划资源行业各类文档提供从分类、处理到应用的全流程指导。方案结合项目现有分类体系和用户需求，建立了系统化的文档处理框架，确保文档能够得到高效、精准的处理，为后续的AI模型训练、知识图谱构建和业务应用提供高质量的结构化数据支持。

## 2. 文档分类体系架构

根据规划资源行业文档的特点和处理需求，将文档分为以下五大类18个子类：

### 2.1 一级分类

| 一级分类 | 描述 | 典型文件格式 | 处理重点 |
|--------|------|-------------|---------|
| 文本类 | 以文字内容为主，结构相对规范的文档 | PDF、DOCX、TXT | 文本提取、结构化处理、内容理解 |
| 图文类 | 图片与文字内容并重，图文紧密结合的文档 | PDF、PPTX、扫描件 | 图像质量优化、OCR识别、图文关联 |
| 证件类 | 具有固定格式和特定用途的证明性文件 | PDF、JPG、PNG | 证件类型识别、信息提取、真伪验证 |
| 图像类 | 以图像内容为主，包含空间信息的文档 | TIFF、JPG、PNG、DWG | 图像增强、特征提取、空间分析 |
| 表格类 | 以表格形式呈现结构化数据的文档 | PDF、XLSX、CSV | 表格结构识别、数据提取、格式转换 |

### 2.2 二级分类

1. **文本类**
   - 法律法规、政府公文
   - 技术手册
   - 规划文件
   - 档案数据
   - 书籍、报刊、新闻稿
   - 期刊、论文
   - 人工编写思维链

2. **图文类**
   - 典型案例--图文并茂--PDF文件
   - 典型案例--图文并茂--扫描文件
   - 汇报稿--图文并茂--由PPT转化而来
   - 彩页

3. **证件类**
   - 权属证明类
   - 审批证件类
   - 资质证书类
   - 登记证明类

4. **图像类**
   - 规划成果类
   - 现状影像类
   - 地籍测绘类
   - 工程建设类

5. **表格类**
   - 统计报表类
   - 审批表单类

## 3. 详细分类描述与加工要点

### 3.1 文本类文档

#### 3.1.1 法律法规、政府公文

**特点**：具有高度权威性、规范性和严谨性，内容结构清晰，术语规范。

**示例**：土地管理法、城乡规划法、政府令、部门规章、规范性文件等。

**处理目标**：保留原文结构，确保内容准确性，建立溯源机制。

**关键处理步骤**：
- 格式统一和规范化处理
- 文本内容提取和结构化
- 章节划分和层级关系建立
- 关键词和术语标注
- 版本和发布机构信息提取

#### 3.1.2 技术手册

**特点**：包含大量文字说明，同时文档中包含比较规范的大长表格，技术性强。

**示例**：规划编制技术规范、测绘技术标准、GIS操作手册等。

**处理目标**：分离文本和表格内容，分别进行结构化处理，建立文本与表格之间的关联关系。

**关键处理步骤**：
- 文本和表格内容分离
- 文本部分的章节结构分析
- 表格内容的结构化提取
- 表格数据类型和单位识别
- 文本与表格内容的关联建立

#### 3.1.3 规划文件

**特点**：包含大量文字，同时文档中配有比较规范的配图，图文结合紧密。

**示例**：城市总体规划、详细规划、专项规划、规划研究报告等。

**处理目标**：分离文本和图像内容，分别进行处理，建立图文关联，确保内容一致性。

**关键处理步骤**：
- 文本和图像内容分离
- 文本部分的主题和要点提取
- 图像内容的特征识别和描述
- 图文对应关系建立
- 规划目标和指标的结构化提取

#### 3.1.4 档案数据

**特点**：包含大量文字，配有规范配图，还包含部分工作审批文件。相当一部分文件是扫描件。

**示例**：土地审批档案、建设项目档案、规划成果档案等。

**处理目标**：对扫描件进行高质量OCR识别，建立档案间的关联关系和时间线。

**关键处理步骤**：
- 扫描件图像预处理
- 高质量OCR文本识别
- 档案元数据提取
- 档案编号和时间信息识别
- 档案间关联关系建立

#### 3.1.5 书籍、报刊、新闻稿

**特点**：书籍包含大量概念性科普内容，有规范的文档结构和文字描述方式。

**示例**：土地管理概论、城市规划原理、行业报刊文章、政策解读新闻等。

**处理目标**：提取核心概念、定义、原理和案例，保留书籍的章节结构和引用关系。

**关键处理步骤**：
- 章节结构分析和提取
- 核心概念和定义提取
- 案例和示例的标注
- 引用关系的识别
- 关键词和术语的提取

#### 3.1.6 期刊、论文

**特点**：典型的论文体，包含标题、作者、摘要、关键词，结构规范，图文比较规范，可能存在数学公式、建筑设计图等。

**示例**：土地科学学报、城市规划学刊、GIS研究论文等。

**处理目标**：提取论文元数据，解析论文结构，处理数学公式、图表、参考文献等特殊内容。

**关键处理步骤**：
- 论文元数据（标题、作者、摘要、关键词）提取
- 论文结构（引言、方法、结果、结论）分析
- 数学公式和符号识别
- 图表内容和说明文字的提取
- 参考文献的规范化处理

#### 3.1.7 人工编写思维链

**特点**：由规资局各业务处室手工编写的问题和答案，质量较高，但思维链可能不规范或不完整。

**示例**：政策咨询问答、业务办理指南、常见问题解答等。

**处理目标**：规范化思维链结构，补充缺失环节，建立问题与答案之间的逻辑关联。

**关键处理步骤**：
- 问题和答案对的提取
- 思维链结构分析和规范化
- 逻辑推理过程的补充和完善
- 相关知识点的关联
- 业务流程的梳理和整合

### 3.2 图文类文档

#### 3.2.1 典型案例--图文并茂--PDF文件

**特点**：有大量的图，文字量相对少，整体以图本、画册形式，内容设计感比较强，彩页形式。

**示例**：城市更新案例集、土地整治典型案例、美丽乡村建设案例等。

**处理目标**：高质量提取图像内容，提取并结构化图像说明文字，建立图像与文字说明的对应关系。

**关键处理步骤**：
- 图像内容提取和质量优化
- 图像说明文字的提取和结构化
- 图像内容的分类和标签化
- 图文对应关系建立
- 案例亮点和经验的总结

#### 3.2.2 典型案例--图文并茂--扫描文件

**特点**：与3.2.1形式相同，但文件采用书籍扫描形式，可能需要OCR识别。

**示例**：历史规划案例集、早期城市建设案例汇编等。

**处理目标**：预处理图像，提高扫描质量，进行精确的OCR文字识别，建立图文对应关系。

**关键处理步骤**：
- 扫描图像预处理（去噪、增强、校正）
- 高质量OCR文字识别
- 图像内容提取和分类
- 图文对应关系建立
- 案例信息的结构化提取

#### 3.2.3 汇报稿--图文并茂--由PPT转化而来

**特点**：PPT的特点在于本页的内容和文字是一致的，但因排版形式问题，可能会有信息比较离散的情况，图文对照情况不完全规范。

**示例**：规划成果汇报、项目进展汇报、政策解读PPT等。

**处理目标**：提取每页的标题、文字内容和图像，重建内容逻辑结构，整合离散信息。

**关键处理步骤**：
- PPT到PDF的高质量转换（保留备注）
- 每页内容的标题、文字和图像提取
- 内容逻辑关系的分析和重建
- 离散信息的整合和结构化
- 关键数据和结论的提取

#### 3.2.4 彩页

**特点**：短篇幅的宣传性材料，包含案例图、实景图等，图文对照情况不完全规范。

**示例**：规划展览彩页、项目宣传彩页、政策解读折页等。

**处理目标**：提取关键信息和核心宣传点，识别图像内容和类型，处理特殊排版和设计元素。

**关键处理步骤**：
- 关键信息点的提取
- 核心宣传主题的识别
- 图像内容的分类和标签化
- 特殊排版和设计元素的处理
- 信息的结构化和标准化

### 3.3 证件类文档

#### 3.3.1 权属证明类

**特点**：证明土地、房屋等不动产权利归属的法律凭证，格式相对固定，信息规范。

**示例**：不动产权证书、集体土地所有权证、国有土地使用证等。

**处理目标**：识别证件类型和真伪，提取权利人、权利类型、权利性质、用途、面积、使用期限等关键信息。

**关键处理步骤**：
- 证件类型识别
- 证件真伪验证
- 关键信息字段的定位和提取
- 信息的结构化和标准化
- 数据质量校验

#### 3.3.2 审批证件类

**特点**：规划、建设等行政许可的法律凭证，包含审批机关、审批内容、有效期等信息。

**示例**：建设工程规划许可证、建设用地规划许可证、乡村建设规划许可证等。

**处理目标**：识别证件类型和审批机关，提取项目名称、建设单位、建设位置、建设规模、发证日期等关键信息。

**关键处理步骤**：
- 证件类型和审批机关识别
- 项目基本信息提取
- 审批内容和条件的结构化
- 有效期和发证信息提取
- 审批流程的梳理

#### 3.3.3 资质证书类

**特点**：证明机构或个人具备特定专业能力的凭证，包含资质等级、范围、有效期等信息。

**示例**：城乡规划编制资质证书、测绘资质证书、房地产估价机构资质证书等。

**处理目标**：识别资质类型和等级，提取证书编号、单位名称、资质范围、有效期、发证机关等关键信息。

**关键处理步骤**：
- 资质类型和等级识别
- 证书编号和基本信息提取
- 资质范围的结构化处理
- 有效期和发证信息提取
- 资质状态的判断

#### 3.3.4 登记证明类

**特点**：证明特定事项已登记的法律凭证，格式相对固定，信息规范。

**示例**：不动产登记簿、土地权利登记证明、建设工程规划许可登记证明等。

**处理目标**：识别登记类型和证明用途，提取权利人、义务人、登记事项、登记日期等关键信息。

**关键处理步骤**：
- 登记类型和证明用途识别
- 权利人和义务人信息提取
- 登记事项的结构化处理
- 登记日期和机关信息提取
- 登记状态的判断

### 3.4 图像类文档

#### 3.4.1 规划成果类

**特点**：规划设计的最终或中间成果，包含各类规划图纸、设计方案图、效果图等。

**示例**：土地利用总体规划图、城市总体规划图、控制性详细规划图、修建性详细规划图等。

**处理目标**：识别图像类型和比例尺，提取图中要素、图例、坐标等信息，进行坐标转换和空间分析。

**关键处理步骤**：
- 图像类型和比例尺识别
- 图例和注记信息提取
- 图中要素的分类和标注
- 坐标系统识别和转换
- 空间分析和数据提取

#### 3.4.2 现状影像类

**特点**：反映土地、城市等现状情况的影像数据，包含航空影像、卫星影像、无人机航拍等。

**示例**：高分卫星影像、航空摄影测量成果、无人机航拍影像等。

**处理目标**：影像预处理（辐射校正、几何校正等），地物识别和分类，变化检测和分析。

**关键处理步骤**：
- 影像质量评估和预处理
- 辐射校正和几何校正
- 地物识别和分类
- 变化检测和分析
- 影像元数据的提取和标准化

#### 3.4.3 地籍测绘类

**特点**：反映土地权属、界址、面积等信息的专业测绘成果。

**示例**：地籍图、宗地图、地形测量图、房产测量图等。

**处理目标**：识别图幅信息、坐标系统、比例尺等元数据，提取界址点、界址线、宗地号、面积等信息。

**关键处理步骤**：
- 图幅信息和元数据提取
- 坐标系统和比例尺识别
- 界址点和界址线提取
- 宗地号和面积信息提取
- 权属信息的关联和整合

#### 3.4.4 工程建设类

**特点**：反映工程建设设计和实施情况的图纸和影像。

**示例**：建筑施工图、结构施工图、工程地质勘察图、工程进度影像等。

**处理目标**：识别工程类型和图纸类型，提取工程设计参数、技术指标、材料信息等。

**关键处理步骤**：
- 工程类型和图纸类型识别
- 设计参数和技术指标提取
- 材料信息和规格的结构化
- 工程进度和质量的评估
- 图纸版本和修改信息的提取

### 3.5 表格类文档

#### 3.5.1 统计报表类

**特点**：反映各类资源、市场、人口等统计数据的表格，结构规范，数据量大。

**示例**：土地利用现状统计报表、房地产市场统计报表、人口统计报表等。

**处理目标**：识别表格结构和数据类型，提取表头、行列数据和统计指标，进行数据清洗和标准化处理。

**关键处理步骤**：
- 表格结构识别和分析
- 表头和行列关系建立
- 数据类型和单位识别
- 数据清洗和标准化
- 统计指标和维度的提取

#### 3.5.2 审批表单类

**特点**：各类行政许可和审批的申请表单，包含申请人、申请事项、申请时间等信息。

**示例**：建设用地申请表、建设工程规划许可申请表、乡村建设规划许可申请表等。

**处理目标**：识别表单类型和用途，提取申请人信息、申请事项、申请时间、审批结果等关键信息。

**关键处理步骤**：
- 表单类型和用途识别
- 申请人和申请事项信息提取
- 申请时间和流程节点提取
- 审批结果和意见的结构化
- 表单数据的完整性校验

## 4. 处理智能体与流程设计

### 4.1 智能体架构

基于文档分类体系，设计了五大类处理智能体，每个智能体负责特定类型文档的处理：

1. **文档处理智能体**：负责文本类文档的处理
2. **图文处理智能体**：负责图文类文档的处理
3. **证件处理智能体**：负责证件类文档的处理
4. **图像处理智能体**：负责图像类文档的处理
5. **表格处理智能体**：负责表格类文档的处理

每个智能体都包含预处理、内容分析、结构化提取和后处理等核心模块，并共享公共服务层提供的基础服务。

### 4.2 文本处理智能体

```python
class TextDocumentProcessor:
    def __init__(self, config):
        self.config = config
        # 初始化各模块
        self.preprocessor = Preprocessor(config)
        self.text_analyzer = TextAnalyzer(config)
        self.structurer = TextStructurer(config)
        self.postprocessor = Postprocessor(config)
    
    def process(self, file_path):
        # 1. 预处理：格式转换、内容清洗
        preprocessed_data = self.preprocessor.process(file_path)
        
        # 2. 内容分析：文本理解、章节划分
        analyzed_data = self.text_analyzer.analyze(preprocessed_data)
        
        # 3. 结构化提取：提取关键信息、建立关系
        structured_data = self.structurer.extract(analyzed_data)
        
        # 4. 后处理：数据校验、标准化
        final_result = self.postprocessor.process(structured_data)
        
        return final_result
```

### 4.3 图文处理智能体

```python
class ImageTextDocumentProcessor:
    def __init__(self, config):
        self.config = config
        # 初始化各模块
        self.preprocessor = Preprocessor(config)
        self.image_extractor = ImageExtractor(config)
        self.text_extractor = TextExtractor(config)
        self.relator = ImageTextRelator(config)
        self.structurer = MultiModalStructurer(config)
    
    def process(self, file_path):
        # 1. 预处理：格式转换、质量优化
        preprocessed_data = self.preprocessor.process(file_path)
        
        # 2. 图像提取：提取图像内容
        images = self.image_extractor.extract(preprocessed_data)
        
        # 3. 文本提取：OCR识别、文本提取
        texts = self.text_extractor.extract(preprocessed_data)
        
        # 4. 图文关联：建立图像与文字的对应关系
        related_data = self.relator.relate(images, texts)
        
        # 5. 结构化处理：整合信息、结构化输出
        final_result = self.structurer.structure(related_data)
        
        return final_result
```

### 4.4 证件处理智能体

```python
class CertificateProcessor:
    def __init__(self, config):
        self.config = config
        # 初始化各模块
        self.preprocessor = Preprocessor(config)
        self.cert_type_identifier = CertificateTypeIdentifier(config)
        self.info_extractor = CertificateInfoExtractor(config)
        self.verifier = CertificateVerifier(config)
        self.structurer = CertificateStructurer(config)
    
    def process(self, file_path):
        # 1. 预处理：图像增强、边缘检测
        preprocessed_data = self.preprocessor.process(file_path)
        
        # 2. 证件类型识别：确定证件类型
        cert_type = self.cert_type_identifier.identify(preprocessed_data)
        
        # 3. 信息提取：提取关键信息字段
        extracted_info = self.info_extractor.extract(preprocessed_data, cert_type)
        
        # 4. 信息验证：验证信息真实性和完整性
        verified_info = self.verifier.verify(extracted_info, cert_type)
        
        # 5. 结构化处理：标准化输出
        final_result = self.structurer.structure(verified_info, cert_type)
        
        return final_result
```

### 4.5 图像处理智能体

```python
class ImageDocumentProcessor:
    def __init__(self, config):
        self.config = config
        # 初始化各模块
        self.preprocessor = Preprocessor(config)
        self.image_analyzer = ImageAnalyzer(config)
        self.feature_extractor = FeatureExtractor(config)
        self.spatial_processor = SpatialProcessor(config)
        self.structurer = ImageStructurer(config)
    
    def process(self, file_path):
        # 1. 预处理：图像增强、格式统一
        preprocessed_data = self.preprocessor.process(file_path)
        
        # 2. 图像分析：识别图像类型、内容特征
        analyzed_data = self.image_analyzer.analyze(preprocessed_data)
        
        # 3. 特征提取：提取图中要素、图例等信息
        extracted_features = self.feature_extractor.extract(analyzed_data)
        
        # 4. 空间处理：坐标转换、空间分析
        spatial_data = self.spatial_processor.process(extracted_features)
        
        # 5. 结构化处理：整合信息、标准化输出
        final_result = self.structurer.structure(spatial_data)
        
        return final_result
```

### 4.6 表格处理智能体

```python
class TableDocumentProcessor:
    def __init__(self, config):
        self.config = config
        # 初始化各模块
        self.preprocessor = Preprocessor(config)
        self.table_detector = TableDetector(config)
        self.structure_analyzer = TableStructureAnalyzer(config)
        self.data_extractor = TableDataExtractor(config)
        self.postprocessor = TablePostprocessor(config)
    
    def process(self, file_path):
        # 1. 预处理：格式转换、内容清洗
        preprocessed_data = self.preprocessor.process(file_path)
        
        # 2. 表格检测：定位文档中的表格
        detected_tables = self.table_detector.detect(preprocessed_data)
        
        # 3. 结构分析：分析表格的行列结构
        analyzed_tables = self.structure_analyzer.analyze(detected_tables)
        
        # 4. 数据提取：提取表格中的数据
        extracted_data = self.data_extractor.extract(analyzed_tables)
        
        # 5. 后处理：数据清洗、标准化和校验
        final_result = self.postprocessor.process(extracted_data)
        
        return final_result
```

## 5. 公共服务层实现

公共服务层为各处理智能体提供基础服务和共享组件，包括OCR服务、分类服务、存储服务等。

```python
class CommonServices:
    def __init__(self):
        # 初始化各基础服务
        self.ocr_service = OCRService()
        self.classification_service = DocumentClassificationService()
        self.storage_service = StorageService()
        self.nlp_service = NLPService()
        self.image_processing_service = ImageProcessingService()
        self.data_validation_service = DataValidationService()
    
    def smart_classify(self, file_path):
        # 智能分类服务：自动识别文档类型
        file_info = self.storage_service.get_file_info(file_path)
        
        # 根据文件格式初步判断
        if file_info['format'] in ['pdf', 'docx', 'txt']:
            # 文本文件：使用文本分类
            text_content = self.ocr_service.extract_text(file_path)
            category = self.classification_service.classify_text(text_content)
        elif file_info['format'] in ['jpg', 'png', 'tiff']:
            # 图像文件：使用图像分类
            image_features = self.image_processing_service.extract_features(file_path)
            category = self.classification_service.classify_image(image_features)
        elif file_info['format'] in ['xlsx', 'csv']:
            # 表格文件：使用表格分类
            table_structure = self.image_processing_service.detect_table(file_path)
            category = self.classification_service.classify_table(table_structure)
        else:
            # 混合类型或未知类型：综合分类
            text_content = self.ocr_service.extract_text(file_path)
            image_features = self.image_processing_service.extract_features(file_path)
            category = self.classification_service.classify_multi_modal(text_content, image_features)
        
        return category
```

## 6. 算子类型及功能概述

在规划资源行业语料加工流程中，主要包含以下几类算子：

| 算子类型 | 主要功能 | 典型工具 | 适用场景 |
|---------|---------|---------|---------|
| 清洗算子 | 文件格式转换、内容清洗与规范化 | PPT到PDF转换工具、文档格式统一工具 | 各类Office文档转换、扫描件处理 |
| Minio算子 | 从分布式存储系统下载和上传文件 | S3下载工具、批量文件传输工具 | 云端文件获取、处理结果存储 |
| 匹配算子 | 文件匹配、迁移和归类 | 智能文件匹配工具、目录整理工具 | 文件分类归档、跨系统数据迁移 |
| 标签算子 | 为文件添加结构化标签和注释 | 自动标签生成工具、多级标签管理工具 | 文档标注、知识图谱构建 |
| 统计算子 | 数据统计、质量评估和进度跟踪 | 文件统计工具、数据质量检查工具 | 项目进度跟踪、数据完整性验证 |

## 7. 文档类型与算子配置清单

### 7.1 文本类文档

#### 7.1.1 法律法规、政府公文

**特点**：具有高度权威性、规范性和严谨性，内容结构清晰，术语规范。

**处理目标**：保留原文结构，确保内容准确性，建立溯源机制。

**算子配置**：
1. **Minio算子**：
   - 工具：s3_download_v5_pdf.py
   - 功能：从Minio存储下载法律法规和政府公文文件
   - 配置参数：设置正确的endpoint_url、aws_access_key_id、aws_secret_access_key和目标文件夹
2. **清洗算子**：
   - 工具：x2pdf_v2.py
   - 功能：确保文件格式统一为PDF格式
   - 配置参数：设置源文件夹和目标文件夹路径
3. **标签算子**：
   - 工具：annotation_script_2.py
   - 功能：添加"法律法规"、"政府公文"等一级标签，以及具体类型的二级标签
   - 配置参数：设置标签体系中的"fagui"、"zhengwu"等标签值
4. **统计算子**：
   - 工具：new Compare.py
   - 功能：统计处理文件数量，确保无遗漏
   - 配置参数：设置输入目录和输出目录路径

#### 7.1.2 技术手册

**特点**：包含大量文字说明，同时文档中包含比较规范的大长表格，技术性强。

**处理目标**：分离文本和表格内容，分别进行结构化处理，建立文本与表格之间的关联关系。

**算子配置**：
1. **Minio算子**：
   - 工具：s3_download_v5_pdf.py
   - 功能：从Minio存储下载技术手册文件
   - 配置参数：设置正确的存储连接信息和目标文件夹
2. **清洗算子**：
   - 工具：x2pdf_v2.py
   - 功能：将不同格式的技术手册统一转换为PDF格式
   - 配置参数：设置源文件夹和目标文件夹路径
3. **匹配算子**：
   - 工具：optimized_mv0903.py
   - 功能：根据文件内容特征识别并归类技术手册
   - 配置参数：设置匹配规则和目标目录结构
4. **标签算子**：
   - 工具：annotation_script_2.py
   - 功能：添加"技术手册"标签，以及具体专业领域的子标签
   - 配置参数：设置标签体系中的"jishushouce"等标签值
5. **统计算子**：
   - 工具：import count.py
   - 功能：统计技术手册数量和处理进度
   - 配置参数：设置统计目录路径

#### 7.1.3 规划文件

**特点**：包含大量文字，同时文档中配有比较规范的配图，图文结合紧密。

**处理目标**：分离文本和图像内容，分别进行处理，建立图文关联，确保内容一致性。

**算子配置**：
1. **Minio算子**：
   - 工具：s3_download_v5_pdf.py
   - 功能：从Minio存储下载规划文件
   - 配置参数：设置正确的存储连接信息和目标文件夹
2. **清洗算子**：
   - 工具：x2pdf_v2.py
   - 功能：将不同格式的规划文件统一转换为PDF格式
   - 配置参数：设置源文件夹和目标文件夹路径
3. **匹配算子**：
   - 工具：optimized_mv0903.py
   - 功能：根据文件内容和文件名特征识别并归类规划文件
   - 配置参数：设置匹配规则和目标目录结构
4. **标签算子**：
   - 工具：annotation_script_2.py
   - 功能：添加"规划文件"标签，以及具体规划类型的子标签
   - 配置参数：设置标签体系中的"guihuawenjian"等标签值
5. **统计算子**：
   - 工具：new Compare.py
   - 功能：统计规划文件数量和处理进度
   - 配置参数：设置输入目录和输出目录路径

#### 7.1.4 档案数据

**特点**：包含大量文字，配有规范配图，还包含部分工作审批文件。相当一部分文件是扫描件。

**处理目标**：对扫描件进行高质量OCR识别，建立档案间的关联关系和时间线。

**算子配置**：
1. **Minio算子**：
   - 工具：s3_download_v5_pdf.py
   - 功能：从Minio存储下载档案数据
   - 配置参数：设置正确的存储连接信息和目标文件夹
2. **清洗算子**：
   - 工具：x2pdf_v2.py
   - 功能：将扫描件和其他格式的档案数据统一转换为PDF格式
   - 配置参数：设置源文件夹和目标文件夹路径
3. **匹配算子**：
   - 工具：optimized_mv0903.py
   - 功能：根据档案编号和内容特征匹配和归类档案数据
   - 配置参数：设置匹配规则和目标目录结构
4. **标签算子**：
   - 工具：annotation_script_2.py
   - 功能：添加"档案数据"标签，以及具体档案类型的子标签
   - 配置参数：设置标签体系中的"dangan"等标签值
5. **统计算子**：
   - 工具：import count.py
   - 功能：统计档案数据数量和处理进度
   - 配置参数：设置统计目录路径

#### 7.1.5 书籍、报刊、新闻稿

**特点**：书籍包含大量概念性科普内容，有规范的文档结构和文字描述方式。

**处理目标**：提取核心概念、定义、原理和案例，保留书籍的章节结构和引用关系。

**算子配置**：
1. **Minio算子**：
   - 工具：s3_download_v5_pdf.py
   - 功能：从Minio存储下载书籍、报刊、新闻稿文件
   - 配置参数：设置正确的存储连接信息和目标文件夹
2. **清洗算子**：
   - 工具：x2pdf_v2.py
   - 功能：将不同格式的出版物统一转换为PDF格式
   - 配置参数：设置源文件夹和目标文件夹路径
3. **标签算子**：
   - 工具：annotation_script_2.py
   - 功能：添加"书籍"、"报刊"、"新闻稿"等标签，以及具体主题的子标签
   - 配置参数：设置标签体系中的"shuji"、"baokan"等标签值
4. **统计算子**：
   - 工具：new Compare.py
   - 功能：统计出版物数量和处理进度
   - 配置参数：设置输入目录和输出目录路径

#### 7.1.6 期刊、论文

**特点**：典型的论文体，包含标题、作者、摘要、关键词，结构规范，图文比较规范，可能存在数学公式、建筑设计图等。

**处理目标**：提取论文元数据，解析论文结构，处理数学公式、图表、参考文献等特殊内容。

**算子配置**：
1. **Minio算子**：
   - 工具：s3_download_v5_pdf.py
   - 功能：从Minio存储下载期刊、论文文件
   - 配置参数：设置正确的存储连接信息和目标文件夹
2. **清洗算子**：
   - 工具：x2pdf_v2.py
   - 功能：将不同格式的期刊、论文统一转换为PDF格式
   - 配置参数：设置源文件夹和目标文件夹路径
3. **标签算子**：
   - 工具：annotation_script_2.py
   - 功能：添加"期刊"、"论文"等标签，以及具体研究领域的子标签
   - 配置参数：设置标签体系中的"qikan"、"lunwen"等标签值
4. **统计算子**：
   - 工具：import count.py
   - 功能：统计期刊、论文数量和处理进度
   - 配置参数：设置统计目录路径

#### 7.1.7 人工编写思维链

**特点**：由规资局各业务处室手工编写的问题和答案，质量较高，但思维链可能不规范或不完整。

**处理目标**：规范化思维链结构，补充缺失环节，建立问题与答案之间的逻辑关联。

**算子配置**：
1. **Minio算子**：
   - 工具：s3_download_v5_pdf.py
   - 功能：从Minio存储下载思维链文件
   - 配置参数：设置正确的存储连接信息和目标文件夹
2. **清洗算子**：
   - 工具：x2pdf_v2.py
   - 功能：将不同格式的思维链文件统一转换为PDF格式
   - 配置参数：设置源文件夹和目标文件夹路径
3. **标签算子**：
   - 工具：annotation_script_2.py
   - 功能：添加"思维链"标签，以及具体业务领域的子标签
   - 配置参数：设置标签体系中的"siweilian"等标签值
4. **统计算子**：
   - 工具：new Compare.py
   - 功能：统计思维链数量和处理进度
   - 配置参数：设置输入目录和输出目录路径

### 7.2 图文类文档

#### 7.2.1 典型案例--图文并茂--PDF文件

**特点**：有大量的图，文字量相对少，整体以图本、画册形式，内容设计感比较强，彩页形式。

**处理目标**：高质量提取图像内容，提取并结构化图像说明文字，建立图像与文字说明的对应关系。

**算子配置**：
1. **Minio算子**：
   - 工具：s3_download_v5_pdf.py
   - 功能：从Minio存储下载典型案例PDF文件
   - 配置参数：设置正确的存储连接信息和目标文件夹
2. **清洗算子**：
   - 工具：x2pdf_v2.py
   - 功能：确保文件格式统一为PDF格式
   - 配置参数：设置源文件夹和目标文件夹路径
3. **匹配算子**：
   - 工具：optimized_mv0903.py
   - 功能：根据文件内容和文件名特征识别并归类典型案例
   - 配置参数：设置匹配规则和目标目录结构
4. **标签算子**：
   - 工具：annotation_script_2.py
   - 功能：添加"典型案例"标签，以及具体案例类型的子标签
   - 配置参数：设置标签体系中的"anlilei"等标签值
5. **统计算子**：
   - 工具：import count.py
   - 功能：统计典型案例数量和处理进度
   - 配置参数：设置统计目录路径

#### 7.2.2 典型案例--图文并茂--扫描文件

**特点**：与7.2.1形式相同，但文件采用书籍扫描形式，可能需要OCR识别。

**处理目标**：预处理图像，提高扫描质量，进行精确的OCR文字识别，建立图文对应关系。

**算子配置**：
1. **Minio算子**：
   - 工具：s3_download_v5_pdf.py
   - 功能：从Minio存储下载典型案例扫描文件
   - 配置参数：设置正确的存储连接信息和目标文件夹
2. **清洗算子**：
   - 工具：x2pdf_v2.py
   - 功能：将扫描件统一转换为PDF格式
   - 配置参数：设置源文件夹和目标文件夹路径
3. **匹配算子**：
   - 工具：optimized_mv0903.py
   - 功能：根据文件内容和文件名特征识别并归类扫描版典型案例
   - 配置参数：设置匹配规则和目标目录结构
4. **标签算子**：
   - 工具：annotation_script_2.py
   - 功能：添加"典型案例"、"扫描件"标签，以及具体案例类型的子标签
   - 配置参数：设置标签体系中的"anlilei"、"saomiaojian"等标签值
5. **统计算子**：
   - 工具：new Compare.py
   - 功能：统计扫描版典型案例数量和处理进度
   - 配置参数：设置输入目录和输出目录路径

#### 7.2.3 汇报稿--图文并茂--由PPT转化而来

**特点**：PPT的特点在于本页的内容和文字是一致的，但因排版形式问题，可能会有信息比较离散的情况，图文对照情况不完全规范。

**处理目标**：提取每页的标题、文字内容和图像，重建内容逻辑结构，整合离散信息。

**算子配置**：
1. **Minio算子**：
   - 工具：s3_download_v5_pdf.py
   - 功能：从Minio存储下载PPT汇报稿文件
   - 配置参数：设置正确的存储连接信息和目标文件夹
2. **清洗算子**：
   - 工具：improved_ppt2pdf.py
   - 功能：将PPT文件转换为包含备注的PDF文件
   - 配置参数：设置源文件夹、目标文件夹、字体路径、备注字体大小等
   - 示例：`ppt_to_pdf_with_notes(ppt_path, pdf_path, notes_font_size=20, delete_temp=True)`
3. **标签算子**：
   - 工具：annotation_script_2.py
   - 功能：添加"汇报稿"标签，以及具体汇报主题的子标签
   - 配置参数：设置标签体系中的"huibaogao"等标签值
4. **统计算子**：
   - 工具：import count.py
   - 功能：统计汇报稿数量和处理进度
   - 配置参数：设置统计目录路径

#### 7.2.4 彩页

**特点**：短篇幅的宣传性材料，包含案例图、实景图等，图文对照情况不完全规范。

**处理目标**：提取关键信息和核心宣传点，识别图像内容和类型，处理特殊排版和设计元素。

**算子配置**：
1. **Minio算子**：
   - 工具：s3_download_v5_pdf.py
   - 功能：从Minio存储下载彩页文件
   - 配置参数：设置正确的存储连接信息和目标文件夹
2. **清洗算子**：
   - 工具：x2pdf_v2.py
   - 功能：将彩页文件统一转换为PDF格式
   - 配置参数：设置源文件夹和目标文件夹路径
3. **匹配算子**：
   - 工具：optimized_mv0903.py
   - 功能：根据文件内容和文件名特征识别并归类彩页
   - 配置参数：设置匹配规则和目标目录结构
4. **标签算子**：
   - 工具：annotation_script_2.py
   - 功能：添加"彩页"标签，以及具体宣传主题的子标签
   - 配置参数：设置标签体系中的"caiye"等标签值
5. **统计算子**：
   - 工具：new Compare.py
   - 功能：统计彩页数量和处理进度
   - 配置参数：设置输入目录和输出目录路径

### 7.3 证件类文档

#### 7.3.1 权属证明类

**特点**：证明土地、房屋等不动产权利归属的法律凭证，格式相对固定，信息规范。

**处理目标**：识别证件类型和真伪，提取权利人、权利类型、权利性质、用途、面积、使用期限等关键信息。

**算子配置**：
1. **Minio算子**：
   - 工具：s3_download_v5_pdf.py
   - 功能：从Minio存储下载权属证明文件
   - 配置参数：设置正确的存储连接信息和目标文件夹
2. **清洗算子**：
   - 工具：x2pdf_v2.py
   - 功能：将不同格式的权属证明统一转换为PDF格式
   - 配置参数：设置源文件夹和目标文件夹路径
3. **匹配算子**：
   - 工具：optimized_mv0903.py
   - 功能：根据文件内容和文件名特征识别并归类权属证明
   - 配置参数：设置匹配规则和目标目录结构
4. **标签算子**：
   - 工具：annotation_script_2.py
   - 功能：添加"权属证明"标签，以及具体证明类型的子标签
   - 配置参数：设置标签体系中的"quanshuzhengming"等标签值
5. **统计算子**：
   - 工具：import count.py
   - 功能：统计权属证明数量和处理进度
   - 配置参数：设置统计目录路径

#### 7.3.2 审批证件类

**特点**：规划、建设等行政许可的法律凭证，包含审批机关、审批内容、有效期等信息。

**处理目标**：识别证件类型和审批机关，提取项目名称、建设单位、建设位置、建设规模、发证日期等关键信息。

**算子配置**：
1. **Minio算子**：
   - 工具：s3_download_v5_pdf.py
   - 功能：从Minio存储下载审批证件文件
   - 配置参数：设置正确的存储连接信息和目标文件夹
2. **清洗算子**：
   - 工具：x2pdf_v2.py
   - 功能：将不同格式的审批证件统一转换为PDF格式
   - 配置参数：设置源文件夹和目标文件夹路径
3. **匹配算子**：
   - 工具：optimized_mv0903.py
   - 功能：根据文件内容和文件名特征识别并归类审批证件
   - 配置参数：设置匹配规则和目标目录结构
4. **标签算子**：
   - 工具：annotation_script_2.py
   - 功能：添加"审批证件"标签，以及具体证件类型的子标签
   - 配置参数：设置标签体系中的"shenpizhengjian"等标签值
5. **统计算子**：
   - 工具：new Compare.py
   - 功能：统计审批证件数量和处理进度
   - 配置参数：设置输入目录和输出目录路径

#### 7.3.3 资质证书类

**特点**：证明机构或个人具备特定专业能力的凭证，包含资质等级、范围、有效期等信息。

**处理目标**：识别资质类型和等级，提取证书编号、单位名称、资质范围、有效期、发证机关等关键信息。

**算子配置**：
1. **Minio算子**：
   - 工具：s3_download_v5_pdf.py
   - 功能：从Minio存储下载资质证书文件
   - 配置参数：设置正确的存储连接信息和目标文件夹
2. **清洗算子**：
   - 工具：x2pdf_v2.py
   - 功能：将不同格式的资质证书统一转换为PDF格式
   - 配置参数：设置源文件夹和目标文件夹路径
3. **匹配算子**：
   - 工具：optimized_mv0903.py
   - 功能：根据文件内容和文件名特征识别并归类资质证书
   - 配置参数：设置匹配规则和目标目录结构
4. **标签算子**：
   - 工具：annotation_script_2.py
   - 功能：添加"资质证书"标签，以及具体资质类型的子标签
   - 配置参数：设置标签体系中的"zizhizhengshu"等标签值
5. **统计算子**：
   - 工具：import count.py
   - 功能：统计资质证书数量和处理进度
   - 配置参数：设置统计目录路径

#### 7.3.4 登记证明类

**特点**：证明特定事项已登记的法律凭证，格式相对固定，信息规范。

**处理目标**：识别登记类型和证明用途，提取权利人、义务人、登记事项、登记日期等关键信息。

**算子配置**：
1. **Minio算子**：
   - 工具：s3_download_v5_pdf.py
   - 功能：从Minio存储下载登记证明文件
   - 配置参数：设置正确的存储连接信息和目标文件夹
2. **清洗算子**：
   - 工具：x2pdf_v2.py
   - 功能：将不同格式的登记证明统一转换为PDF格式
   - 配置参数：设置源文件夹和目标文件夹路径
3. **匹配算子**：
   - 工具：optimized_mv0903.py
   - 功能：根据文件内容和文件名特征识别并归类登记证明
   - 配置参数：设置匹配规则和目标目录结构
4. **标签算子**：
   - 工具：annotation_script_2.py
   - 功能：添加"登记证明"标签，以及具体登记类型的子标签
   - 配置参数：设置标签体系中的"dengjizhengming"等标签值
5. **统计算子**：
   - 工具：new Compare.py
   - 功能：统计登记证明数量和处理进度
   - 配置参数：设置输入目录和输出目录路径

### 7.4 图像类文档

#### 7.4.1 规划成果类

**特点**：规划设计的最终或中间成果，包含各类规划图纸、设计方案图、效果图等。

**处理目标**：识别图像类型和比例尺，提取图中要素、图例、坐标等信息，进行坐标转换和空间分析。

**算子配置**：
1. **Minio算子**：
   - 工具：s3_download_v5_pdf.py
   - 功能：从Minio存储下载规划成果图像文件
   - 配置参数：设置正确的存储连接信息和目标文件夹
2. **匹配算子**：
   - 工具：optimized_mv0903.py
   - 功能：根据文件内容和文件名特征识别并归类规划成果
   - 配置参数：设置匹配规则和目标目录结构
3. **标签算子**：
   - 工具：annotation_script_2.py
   - 功能：添加"规划成果"标签，以及具体成果类型的子标签
   - 配置参数：设置标签体系中的"guihuachengguo"等标签值
4. **统计算子**：
   - 工具：import count.py
   - 功能：统计规划成果数量和处理进度
   - 配置参数：设置统计目录路径

#### 7.4.2 现状影像类

**特点**：反映土地、城市等现状情况的影像数据，包含航空影像、卫星影像、无人机航拍等。

**处理目标**：影像预处理（辐射校正、几何校正等），地物识别和分类，变化检测和分析。

**算子配置**：
1. **Minio算子**：
   - 工具：s3_download_v5_pdf.py
   - 功能：从Minio存储下载现状影像文件
   - 配置参数：设置正确的存储连接信息和目标文件夹
2. **匹配算子**：
   - 工具：optimized_mv0903.py
   - 功能：根据文件内容和文件名特征识别并归类现状影像
   - 配置参数：设置匹配规则和目标目录结构
3. **标签算子**：
   - 工具：annotation_script_2.py
   - 功能：添加"现状影像"标签，以及具体影像类型的子标签
   - 配置参数：设置标签体系中的"xianzhuangyingxiang"等标签值
4. **统计算子**：
   - 工具：new Compare.py
   - 功能：统计现状影像数量和处理进度
   - 配置参数：设置输入目录和输出目录路径

#### 7.4.3 地籍测绘类

**特点**：反映土地权属、界址、面积等信息的专业测绘成果。

**处理目标**：识别图幅信息、坐标系统、比例尺等元数据，提取界址点、界址线、宗地号、面积等信息。

**算子配置**：
1. **Minio算子**：
   - 工具：s3_download_v5_pdf.py
   - 功能：从Minio存储下载地籍测绘文件
   - 配置参数：设置正确的存储连接信息和目标文件夹
2. **匹配算子**：
   - 工具：optimized_mv0903.py
   - 功能：根据文件内容和文件名特征识别并归类地籍测绘成果
   - 配置参数：设置匹配规则和目标目录结构
3. **标签算子**：
   - 工具：annotation_script_2.py
   - 功能：添加"地籍测绘"标签，以及具体测绘类型的子标签
   - 配置参数：设置标签体系中的"dijicehui"等标签值
4. **统计算子**：
   - 工具：import count.py
   - 功能：统计地籍测绘成果数量和处理进度
   - 配置参数：设置统计目录路径

#### 7.4.4 工程建设类

**特点**：反映工程建设设计和实施情况的图纸和影像。

**处理目标**：识别工程类型和图纸类型，提取工程设计参数、技术指标、材料信息等。

**算子配置**：
1. **Minio算子**：
   - 工具：s3_download_v5_pdf.py
   - 功能：从Minio存储下载工程建设文件
   - 配置参数：设置正确的存储连接信息和目标文件夹
2. **匹配算子**：
   - 工具：optimized_mv0903.py
   - 功能：根据文件内容和文件名特征识别并归类工程建设文件
   - 配置参数：设置匹配规则和目标目录结构
3. **标签算子**：
   - 工具：annotation_script_2.py
   - 功能：添加"工程建设"标签，以及具体工程类型的子标签
   - 配置参数：设置标签体系中的"gongchengjianshe"等标签值
4. **统计算子**：
   - 工具：new Compare.py
   - 功能：统计工程建设文件数量和处理进度
   - 配置参数：设置输入目录和输出目录路径

### 7.5 表格类文档

#### 7.5.1 统计报表类

**特点**：反映各类资源、市场、人口等统计数据的表格，结构规范，数据量大。

**处理目标**：识别表格结构和数据类型，提取表头、行列数据和统计指标，进行数据清洗和标准化处理。

**算子配置**：
1. **Minio算子**：
   - 工具：s3_download_v5_pdf.py
   - 功能：从Minio存储下载统计报表文件
   - 配置参数：设置正确的存储连接信息和目标文件夹
2. **清洗算子**：
   - 工具：x2pdf_v2.py
   - 功能：将不同格式的统计报表统一转换为PDF格式
   - 配置参数：设置源文件夹和目标文件夹路径
3. **匹配算子**：
   - 工具：optimized_mv0903.py
   - 功能：根据文件内容和文件名特征识别并归类统计报表
   - 配置参数：设置匹配规则和目标目录结构
4. **标签算子**：
   - 工具：annotation_script_2.py
   - 功能：添加"统计报表"标签，以及具体报表类型的子标签
   - 配置参数：设置标签体系中的"tongjibaobiao"等标签值
5. **统计算子**：
   - 工具：import count.py
   - 功能：统计统计报表数量和处理进度
   - 配置参数：设置统计目录路径

#### 7.5.2 审批表单类

**特点**：各类行政许可和审批的申请表单，包含申请人、申请事项、申请时间等信息。

**处理目标**：识别表单类型和用途，提取申请人信息、申请事项、申请时间、审批结果等关键信息。

**算子配置**：
1. **Minio算子**：
   - 工具：s3_download_v5_pdf.py
   - 功能：从Minio存储下载审批表单文件
   - 配置参数：设置正确的存储连接信息和目标文件夹
2. **清洗算子**：
   - 工具：x2pdf_v2.py
   - 功能：将不同格式的审批表单统一转换为PDF格式
   - 配置参数：设置源文件夹和目标文件夹路径
3. **匹配算子**：
   - 工具：optimized_mv0903.py
   - 功能：根据文件内容和文件名特征识别并归类审批表单
   - 配置参数：设置匹配规则和目标目录结构
4. **标签算子**：
   - 工具：annotation_script_2.py
   - 功能：添加"审批表单"标签，以及具体表单类型的子标签
   - 配置参数：设置标签体系中的"shenpibiaodan"等标签值
5. **统计算子**：
   - 工具：new Compare.py
   - 功能：统计审批表单数量和处理进度
   - 配置参数：设置输入目录和输出目录路径

## 8. 算子处理流程图

以下是各类算子在文档处理流程中的典型调用顺序：

1. **Minio算子** → 2. **清洗算子** → 3. **匹配算子** → 4. **标签算子** → 5. **统计算子**

**说明**：
- 该处理流程适用于大多数文档类型，但某些特殊文档可能需要调整算子的使用顺序或跳过部分算子。
- 在实际应用中，应根据具体文档类型的特点和处理目标，灵活配置和组合各类算子。
- 对于某些复杂文档，可能需要多次调用同一类算子或使用自定义的算子组合。

## 9. 输入输出示例

### 9.1 文本类（法律法规）示例

#### 输入：
```python
# 输入文件：《中华人民共和国土地管理法》PDF文件
from text_document_processor import TextDocumentProcessor

# 初始化处理器
config = {
    "extract_metadata": True,
    "structure_chapters": True,
    "enable_ner": True,
    "output_format": "json"
}
processor = TextDocumentProcessor(config)

# 处理文件
result = processor.process("path/to/land_management_law.pdf")
```

#### 输出：
```json
{
  "document_type": "法律法规",
  "title": "中华人民共和国土地管理法",
  "metadata": {
    "issuing_authority": "全国人民代表大会常务委员会",
    "issue_date": "2019-08-26",
    "effective_date": "2020-01-01",
    "version": "2019年修订版"
  },
  "structure": {
    "chapters": [
      {
        "chapter_num": "第一章",
        "chapter_title": "总则",
        "sections": [
          {
            "section_num": "第一条",
            "content": "为了加强土地管理，维护土地的社会主义公有制，保护、开发土地资源，合理利用土地，切实保护耕地，促进社会经济的可持续发展，根据宪法，制定本法。",
            "keywords": ["土地管理", "社会主义公有制", "土地资源", "耕地保护", "可持续发展"]
          },
          // 更多条款...
        ]
      },
      // 更多章节...
    ]
  },
  "entities": [
    {"type": "LAW", "text": "中华人民共和国土地管理法"},
    {"type": "DATE", "text": "2019-08-26"},
    {"type": "DATE", "text": "2020-01-01"}
    // 更多实体...
  ]
}
```

### 9.2 图文类（典型案例）示例

#### 输入：
```python
# 输入文件：《XX市城市更新典型案例》PDF文件
from image_text_document_processor import ImageTextDocumentProcessor

# 初始化处理器
config = {
    "extract_images": True,
    "image_quality": 90,
    "enable_ocr": True,
    "relate_images_text": True,
    "output_format": "json"
}
processor = ImageTextDocumentProcessor(config)

# 处理文件
result = processor.process("path/to/city_update_cases.pdf")
```

#### 输出：
```json
{
  "document_type": "典型案例--图文并茂--PDF文件",
  "title": "XX市城市更新典型案例",
  "cases": [
    {
      "case_id": "CASE001",
      "case_title": "XX旧工业区改造项目",
      "summary": "本项目将原有的老旧工业区改造为集商业、文化、居住于一体的综合性社区...",
      "images": [
        {
          "image_id": "IMG001",
          "description": "改造前的工业区现状",
          "features": ["工厂建筑", "仓库", "道路狭窄"],
          "related_text": "改造前，该区域主要为上世纪80年代建设的工业厂房，建筑老化严重，基础设施落后..."
        },
        {
          "image_id": "IMG002",
          "description": "改造后的社区新貌",
          "features": ["商业中心", "文化广场", "居民楼"],
          "related_text": "改造后，该区域焕然一新，成为城市新的商业文化中心，吸引了大量市民和游客..."
        }
      ],
      "key_points": ["产业升级", "空间重构", "文化传承", "民生改善"]
    },
    // 更多案例...
  ]
}
```

## 10. 配置和使用指南

### 10.1 环境配置

1. **Python环境**：确保安装了Python 3.7或更高版本
2. **依赖库安装**：根据各算子的要求安装相应的依赖库
   - 清洗算子：`pip install pillow reportlab pywin32`
   - Minio算子：`pip install boto3 botocore`
   - 标签算子：`pip install pandas`
3. **路径配置**：确保所有文件路径使用绝对路径，避免相对路径带来的问题

### 10.2 使用示例

以处理汇报稿--图文并茂--由PPT转化而来的文档为例：

```python
# 1. 从Minio下载PPT文件
s3_download_v5_pdf.py --receipt-no P2025070700001 --target-folder D:\temp\input

# 2. 将PPT转换为包含备注的PDF
from improved_ppt2pdf import ppt_to_pdf_with_notes

input_dir = r"D:\temp\input"
output_dir = r"D:\temp\output"

# 确保输出目录存在
import os
os.makedirs(output_dir, exist_ok=True)

# 批量处理
for file in os.listdir(input_dir):
    if file.endswith((\'.pptx\', \'.ppt\')):
        ppt_path = os.path.join(input_dir, file)
        pdf_path = os.path.join(output_dir, file.replace(\'.pptx\', \'.pdf\').replace(\'.ppt\', \'.pdf\'))
        
        success = ppt_to_pdf_with_notes(
            ppt_path,
            pdf_path,
            notes_font_size=20,
            delete_temp=True
        )
        
        if success:
            print(f"成功转换: {file}")
        else:
            print(f"转换失败: {file}")

# 3. 添加标签（使用annotation_script_2.py）
# ...

# 4. 统计处理结果（使用import count.py或new Compare.py）
# ...
```

## 11. 总结

本方案整合了规划资源行业的文档分类体系、加工处理方案和算子配置规范，建立了包含文本类、图文类、证件类、图像类和表格类五大一级分类及18个二级分类的完整架构。方案详细描述了各类文档的特点、处理目标和关键处理步骤，设计了五大处理智能体和公共服务层，提供了各类算子的详细配置方案和使用指南。

通过本方案，规划资源行业的各类文档可以得到高效、精准的处理，为后续的AI模型训练、知识图谱构建和业务应用提供高质量的结构化数据支持。在实际应用中，应根据具体的业务需求和文档特点，灵活调整和优化处理流程和算子配置，确保处理结果的准确性和实用性。同时，随着技术的发展和业务的变化，应定期评估和更新本方案，以适应不断变化的需求。

版本：V1.0
日期：2023年11月