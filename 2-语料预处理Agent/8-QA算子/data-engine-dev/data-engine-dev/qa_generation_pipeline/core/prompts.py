
concept_extraction_prompt = """请根据以下文本生成脑图，要求如下：
1. 梳理该主题的核心概念、主要分类及关键信息；
2. 按照逻辑层级（如核心主题 - 一级分支 - 二级分支）展开，逻辑层级标题必须完全来自原文，禁止总结；
3. 可包含定义、特点、例子、关联因素等细节，确保信息完整；
4. 结构清晰，层次分明，便于理解和拓展。
5. 保证逻辑层级在三层以内，只包含核心主题、一级分支、二级分支三个逻辑层级，且完全来自与原文。

格式如下：
【{title}】  
- 一、
    -  
    - 
    - 
    -  
- 二、
    - 
    - 
    ...

例子：
## **《上海市市政交通基础设施详细规划实施深化操作规程》和《应用清单（2025版）》起草情况**
- 一、制定必要性
- 上位依据：《上海市控制性详细规划制定办法》（34号令）第二十二条
- 现有文件不足：503号文对市政交通项目要求不细、514号文规定不精准全面
- 目的：提高效率+守住管控底线+处理权益冲突等
- 二、制订过程
- 试点总结：2023年以来24个不同类型项目试点
- 征求意见：多次征求局内多部门、区局、派出机构及多家单位意见并完善
- 三、主要内容
- （一）《操作规程》
    - 定义：综合34号令、503号文明确
    - 适用范围：公路、轨道等线性工程及场站设施等，实行清单管理
    - 职责分工：区局/派出机构（控详/郊野控详）、行业主管部门（专项规划）为实施主体；审批部门审查，局市政处+监督处指导监督
    - 操作程序：方案研究、适用性研判等8步（专家意见可选，部分流程可并行）
    - 成果应用：实施深化方案+更新图则，图则作为审批依据
    - 监督检查：局市政处总结评估，监督处建日常监管制度
- （二）《应用清单（2025版）》
    - 限制类：含不符合永久基本农田保护、黄浦江/苏州河核心区段工程等10类
    - 适用类：含公路/道路工程、轨道工程等7类项目的具体适用情形（如红线偏移幅度、场站用地调整等）
- 四、下一步工作
- 拟提交局长办公会审议后修改发文，后续开展业务指导和政策宣贯

文本内容：
{text}
"""

context_extraction_prompt = """
根据标题用markdown把所给部分文档的目录提取出来。

文本：
{text}

目录：
"""

concept_question_prompt = """
请根据以下规范性材料相关目录生成10-15个概念型问题：
概念型问题 （选择业务工作中最专业概念提问，如定义、特征，拒绝对精准细节的提问，不符合概念型问题定义）
规范性材料突出权威性，问题以检索类为主（如环节流程、责任主体等），回答内容零自由，严格按照条文。
你会同时接收到AI生成的目录和原文，注意，对于你所给到的政策性问题来说，每个小节之间的内容都相对独立，对每个小节提出概念性的问题，对于每个章节则是根据章节下的小节提出总结的概念性问题。
问题范围必须不跨层级、跨模块关联，不能出现“一级章节”，“一级分支”，“二级分支”等脑图专业词。
问题的核心要素必须是目录中直接列出和文中实际有关联的内容，拒绝隐性推测。
问题中避免出现真实人名，具体的事件（包含时间，地点，人物三要素的案件），即有脱敏需求。
返回格式：一行一个问题，问题中不能有多个问题，且问题被<Q></Q>包裹
问题主语需基于文档标题或内容补充完整定语（如当文件标题为‘厨房设备灭火装置’时，将问题中‘启动方式’修正为‘厨房设备灭火装置的启动方式’）


<Q>Question1</Q>
<Q>Question2</Q>
<Q>Question3</Q>
...

例子：
<Q>联合国人居署提出“新城市议程”（New Urban Agenda），强调城市发展应以包容、安全、有韧性和什么为导向，推动全球可持续城市化战略。</Q>
<Q>各市属国有企业应怎么做？</Q>

文件标题/解析：
{title}

原文：
{xmind}

"""


concept_question_answer_prompt = """
#### 一、核心任务
基于提供的规范性材料（Reference），对输入的问题进行筛选与回答。仅处理符合“概念型问题”定义且能从材料中找到对应答案的问题；不符合要求的问题需拒绝回答，并说明理由。


#### 二、问题筛选标准（概念型问题定义）
1. **符合要求的问题类型**：  
   需围绕业务中的**专业概念**提问，具体包括：  
   - 概念的定义（如“什么是城市更新？”）；  
   - 概念的特征/属性（如“合同生效的必备特征有哪些？”）；  
   - 概念的基本原则/核心要素（如“行政处罚应遵循哪些原则？”）。  

2. **需拒绝的问题类型**：  
   - 涉及“精准细节”的提问（如“某条款第3款的具体数值是多少？”“XX流程的第2步操作细节是什么？”）；  
   - 脱离概念本身的检索类问题（如“XX部门的职责范围包括哪些具体事项？”—— 属于流程/责任主体类，非概念型）；  
   - 需通过总结、合并原文内容才能回答的问题（如“将3个章节的内容合并说明某概念”）。  


#### 三、回答要求（符合筛选标准的问题）
1. **零自由原则**：  
   - 严格依据Reference原文内容回答，禁止任何脱离原文的总结、概括、转述或补充；  
   - 禁止使用“等”“之类”等省略词汇，需完整呈现原文所有相关内容；  
   - 标点符号、表述逻辑需与原文保持一致（原文分点则Answer分点，原文段落则Answer保持段落）。  

2. **COT（思维链）要求**：  
   - 需明确指出答案对应的**具体条款章节**（如“第三章第一节”“总则第5条”）；  
   - 需完整摘录该章节中与问题相关的原文细节（不可简写），并在摘录内容结尾（句号后或短语结尾）标注引用来源{{ref_i}}（i为Reference的编号）；  
   - 禁用“原文”“文中”等模糊表述，直接呈现条款章节和原文内容。  

3. **Answer要求**：  
   - 需完整列出COT中引用的原文内容（无需标注{{ref_i}}，也不可出现“Reference”“ref”等字样）；  
   - 仅呈现原文内容，不添加任何个人解读或补充说明。 (要求符合“零自由原则”) 
      说明问题对应的具体条款章节；
      完整摘录该章节的原文细节（不可简写）
   - 对问题的综合回答
      对问题的回答，可根据具体问题结合条款回答。
   样例话术： 根据...条款/章节; 结合...段落; 从...来看；...



#### 四、拒绝回答的场景及理由
当问题符合以下任一情况时，需拒绝回答，在<COT>中说明理由，<A>中返回“Reject”：  
1. 问题不属于“概念型问题”（如涉及精准细节、流程/责任主体等）；  
2. 原文中无对应答案（即Reference未提及问题相关内容）；  
3. 问题与原文内容矛盾（如问题中的表述与原文定义冲突）；  


#### 五、返回格式（严格遵循）
```
<Q>原始问题（完整保留，包括标点、编号）</Q>
<COT>1. 说明问题对应的具体条款章节；  
2. 完整摘录该章节的原文细节（不可简写），并在结尾标注{{ref_i}}；  
3. 若拒绝，说明拒绝理由（如“该问题询问XX流程的具体步骤，属于精准细节，不符合概念型问题定义”）。</COT>
<A>若符合要求：完整呈现原文相关内容（分点/段落与原文一致，无任何总结）；  
说明问题对应的具体条款章节；
完整摘录该章节的原文细节（不可简写）
对问题的回答。
若拒绝：Reject</A>

待筛选问题：
{question}

原文：
{content}
```


#### 六、示例（符合要求的回答）
```
<Q>城市更新应遵循哪些基本原则？</Q>
<COT>根据“第二章 城市更新的基本原则”，城市更新应遵循六项原则，分别为：  
1. 坚持规划统筹：强化全域规划引领，统筹各类更新资源，实现“多规合一”；  
2. 坚持底线管控：严格守住生态保护、历史文化保护等底线要求；  
3. 坚持节约集约：提高土地利用效率，优先盘活存量资源；  
4. 坚持绿色低碳：推动能源结构优化，推广绿色建筑技术；  
5. 坚持多方参与：鼓励政府、企业、居民等主体共同参与更新过程；  
6. 坚持因地制宜：结合不同区域特点制定差异化更新策略{{ref_1}}。</COT>
<A>城市更新应遵循以下六项基本原则：  
1. 坚持规划统筹：强化全域规划引领，统筹各类更新资源，实现“多规合一”；  
2. 坚持底线管控：严格守住生态保护、历史文化保护等底线要求；  
3. 坚持节约集约：提高土地利用效率，优先盘活存量资源；  
4. 坚持绿色低碳：推动能源结构优化，推广绿色建筑技术；  
5. 坚持多方参与：鼓励政府、企业、居民等主体共同参与更新过程；  
6. 坚持因地制宜：结合不同区域特点制定差异化更新策略。</A>
```


#### 七、示例（拒绝回答）
```
<Q>某区城市更新的具体实施步骤是什么？</Q>
<COT>该问题询问“具体实施步骤”，属于对精准操作细节的提问，不符合“概念型问题”（定义、特征、原则）的定义，故拒绝回答。</COT>
<A>Reject</A>
```
"""

tech_question_prompt = """
请根据以下技术性材料生成2-5个应用型问题：
应用型问题 （选择题，涉及业务中具体的工作选项与判断标准）
技术性材料确保严谨性，提问以应用类为主（如技术参数等），回答内容低自由，需要思维链，允许参数、适用条件的换算推导。
问题范围必须限定在技术细节或者技术参数之中，问题中无需出现具体的条款序号（如4.4.1），拒绝对概念定义或非技术类的询问。
选项要求有困惑性，不能过于简单直接，不能自问自答。
返回格式：问题中不能有多个问题，且问题被<Q></Q>包裹
<Q>Question1</Q>
<Q>Question2</Q>
<Q>Question3</Q>
...

例子：
<Q>在规划实践中，以下哪些行为属于违反职业伦理或需特别注意的“潜在伦理冲突”？请解释理由。
A. 在同一项目中既作为顾问公司顾问，又为项目的审批专家组成员
B. 在居民未理解规划图纸情况下推进征询签字程序
C. 通过修改图示方式弱化项目对交通系统影响，从而提升通过率
D. 出于公共利益考量，在未报批情况下修改规划红线
E. 向单位领导报告项目执行难点，并建议调整规划技术细节</Q>
<Q>某轨道交通项目需对规划线路进行局部微调，单向线路中心线偏移幅度为原规划控制线宽度的 20%。，该调整是否符合适用类事项要求？以下说法正确的是？
A. 不符合，偏移幅度超过 15% 即不适用 
B. 符合，特殊情况经专题论证后可放宽至 30%
C. 不符合，轨道交通线路调整不属于适用类事项 
D. 符合，无需论证即可直接调整</Q>



文章：
{content}

"""

tech_question_answer_prompt = """
筛选所提供的应用型问题，确认是否能在具体条款章节中找到答案，问题本身是否符合原文，且是否符合应用型问题的定义.
若找不到答案或问题不符合原文，或者问题部分缺失（如选择题缺失选项），如果问题过于简单，即选项没有困惑性或者自问自答，即问题中有明显答案，请从遵循“拒绝回答”回复， COT部分给出拒绝理由，回答为Reject，代表问题被拒绝。
若符合条件，请按照返回格式返回。要求COT部分先列出论据所在的具体的条款章节和设计的技术参数，再对选项进行解析，不用论证应用型问题是否符合，给出具体条款章节和涉及的原文细节，禁用“原文”、 “文中”等模糊不清的说法；答案则是正确的选项，不用加入解析。
应用型问题 （选择题，涉及业务中具体的工作选项与判断标准）
技术性材料确保严谨性，提问以应用类为主（如技术参数等），回答内容低自由，需要思维链，允许参数、适用条件的换算推导。
注意：提高你的要求，回答没有涉及到技术相关或技术参数的，直接杀掉，宁可错杀一千，不放过一个。

Answer要求：


返回格式：问题被<Q></Q>包裹(保证问题完整，不要缺失选项)，答案被<A></A>包裹，思维链被<COT></COT>包裹
<Q>Question</Q>
<COT>Chain of Thought</COT>
<A>Answer:若符合要求：完整呈现原文相关内容（分点/段落与原文一致，无任何总结）；  
1. 说明问题对应的具体条款章节；
2. 完整摘录该章节的原文细节（不可简写）
3. 对问题的回答。</A>

拒绝回答：
<Q>Question</Q>
<COT>拒绝的理由</COT>
<A>Reject</A>

例子：
<Q>乡村内部农村道路的路面宽度应控制在什么范围内？  
A. 不超过6米  
B. 不超过8米  
C. 不超过10米  
D. 不超过12米</Q>
<COT>根据5.4.1 2. 连通村域内部农村道路网络，在不破坏农村自然肌理的前提下，根据实际需要，合理确定农村道路的宽度，可在道路弯道、岔路口、桥梁以及需要设立紧急停车带等处，适当放宽路面宽度，合理布局回车场地和会车场地，路面宽度不应超过8米。所以B选项符合题意</COT>
<A>B</A>

待筛选问题：
{question}

原文：
{content}
"""


book_question_prompt = """
请根据以下规范性材料相关内容生成10-15个分析型或总结型问题：
分析型问题 （涉及业务中最需要评价的对象，分析对象作用、策略等）
总结型问题 （涉及到一个事件的总结概述， 事件两面的对比）
知识性材料要求逻辑推导能力，提问以分析类为主（如作用、策略等），回答内容适度自由，需要思维链，可以进行总结提炼。
问题范围需要覆盖到具体的对象，问题需要涉及一定的总结和分析，拒绝对概念定义或技术类（技术参数，技术细节）的询问。
问题主语需基于文档标题或内容补充完整定语（如当文件标题为‘厨房设备灭火装置’时，将问题中‘启动方式’修正为‘厨房设备灭火装置的启动方式’）
返回格式：问题中不能有多个问题，且问题被<Q></Q>包裹
<Q>Question1</Q>
<Q>Question2</Q>
<Q>Question3</Q>
...

例子：
<Q>曹杨环浜八项行动在提升社区公共空间品质方面起到了哪些关键作用？</Q>
<Q>桂巷坊更新项目如何通过设计策略实现社区商业活力空间的重塑？</Q>
<Q>曹杨新村“15分钟社区生活圈”建设中，多方协作机制对项目推进产生了怎样的影响？</Q>

文件标题：
{title}

文章：
{content}

"""


book_question_answer_prompt = """
筛选所提供的问题，确认是否能在具体条款章节中找到答案，问题本身是否符合原文
若找不到答案或问题不符合原文，或者问题部分缺失（如选择题缺失选项），请从遵循“拒绝回答”回复， COT部分给出拒绝理由，回答为Reject，代表问题被拒绝。
若符合条件，请按照返回格式返回。要求COT部分先列出论据所在的具体的条款章节再进行分析，给出具体条款章节和涉及的原文细节，禁用“原文”、 “文中”等模糊不清的说法；
在COT和回答中一律禁用“原文”、 “文中”等模糊不清的说法。

知识性材料要求逻辑推导能力，回答内容适度自由，需要思维链，可以进行总结提炼。


返回格式：问题被<Q></Q>包裹(保证问题完整，不要缺失选项)，答案被<A></A>包裹，思维链被<COT></COT>包裹
<Q>Question</Q>
<COT>Chain of Thought</COT>
<A>Answer</A>

拒绝回答：
<Q>Question</Q>
<COT>拒绝的理由</COT>
<A>Reject</A>

待筛选问题：
{question}

原文：
{content}
"""



evaluate_prompt = """
你是一个QA评测助手，请基于以下标准严格评估QA对，并根据所给定义为QA对内容进行分类：

各标签详细定义与范例
1. 防火 
核心定义： 指在火灾发生之前，为了消除火灾隐患、降低火灾概率、确保人员疏散安全而进行的所有主动性、预防性工作和相关问题。其工作模式是“主动出击”。
关键词： 预防、检查、审批、宣传、教育、规划、风险评估、隐患整改。
典型应用场景与问题范例：
消防安全检查： 对企事业单位、公共场所、居民小区进行消防设施、安全通道、用火用电等的例行或专项检查。
建设工程消防审验： 对新建、改建、扩建工程的消防设计进行审核和竣工验收。
火灾隐患举报与整改： 处理公众关于堵塞消防通道、违规存放易燃易爆品等隐患的举报，并督促责任方整改。
消防宣传教育： 组织消防知识进社区、进学校、进企业活动，开展消防安全培训、疏散演练。
危险品管理： 对烟花爆竹、易燃易爆化学品的生产、储存、运输环节进行消防安全监管。
制定应急预案： 为重点单位制定火灾扑救和应急疏散预案。
2. 灭火 
核心定义： 指在火灾报警后，从接警出动到灭火救援行动结束全程中，所有以应对处置紧急事件为目标的工作和相关问题。其工作模式是“被动响应”。
关键词： 应急、响应、扑救、救援、处置、调度、战术、战评。
典型应用场景与问题范例：
接警与调度： 接收119火警电话，询问灾情信息，调派最近消防站和相应类型的消防车、人员出动。
火场扑救： 火灾现场的灭火战术展开（如内攻、外围控制、破拆、排烟、供水等）。
应急救援： 火场人员搜救、疏散、高空救援、交通事故救援（破拆救人）、危险化学品泄漏处置等。
火场指挥： 现场指挥体系的建立、通信保障、多部门（如公安、医疗）联动协调。
战评与总结： 火灾扑灭后，对救援过程进行复盘，分析成功经验和不足。
装备实战应用： 消防车、水枪、呼吸器等装备在火场中的使用效能和出现的问题。
3. 通用
核心定义： 指那些支撑“防火”与“灭火”两大体系正常运行的基础性、保障性工作和问题。它们通常不直接区分事前事后，而是为整个消防局的运作提供平台和支持。
关键词： 保障、管理、培训、维护、人事、后勤。
典型应用场景与问题范例：
队伍建设与培训： 消防员的招募、体能技能训练（既包括防火检查技能，也包括灭火救援技能）。
装备管理与维护： 消防车辆、器材、个人防护装备的采购、保养、维修、报废等全生命周期管理。
后勤保障： 消防站宿舍、食堂、车辆油料、被装等后勤事务。
信息技术系统： 消防业务系统、调度系统、数据库的维护和升级。
预算与财务： 申请年度预算，管理各项经费支出。
跨部门协作机制： 与应急管理、公安、医疗、水务、电力等部门建立的固定协作流程。

评测标准：
1. 完整性（completeness）: 
   - 问题主语是否容易混淆，或者定义过于宽泛。
   - 问题中禁止使用具体的法规（文档标题）、标准、图名、表名或文件名称。
   - 答案需覆盖Reference中回答问题所需的所有核心信息点
   - 评分：0/1（不合格/合格）

2. 技术性（technical）:
   - 问题需涉及技术参数、适用条件或推导过程
   - 评分：0/1

3. 知识性（knowledge）:
   - 问题需涉及原理分析、策略或作用阐释
   - 评分：0/1

4. 准确性（correctness）:
   - 答案需严格基于Reference内容，无添加或虚构
   - 评分：0/1

5. 幻觉检测（hallucination）:
   - 答案中每句事实陈述必须能被Reference直接支持
   - 评分：0/1（存在任意幻觉即0分）

6. 难度（difficulty）:
   - 根据问题复杂度和所需推理深度评分（1-5分）
   - 若答案可直接从问题(并非REF)中推导则计0分

7. 问题类别(category):
   - 根据问题所陈述的内容/主题判断QA对的类别
   - 分类：(防火/灭火/通用)   

返回格式（JSON）：
{{
    "reason": "简要综述优缺点，问题分类依据，重点说明主语完整性、覆盖率及幻觉问题",
    "completeness": 0,
    "technical": 0,
    "knowledge": 0,
    "correctness": 0,
    "hallucination": 0,
    "difficulty": 0,
    "category": "防火/灭火/通用 三选一"
}}

输入：
{QA_pair}
"""

evaluate_prompt_common = """
你是一个QA评测助手，请基于以下标准严格评估QA对：

评测标准：
1. 完整性（completeness）: 
   - 问题主语是否容易混淆，或者定义过于宽泛。
   - 问题中禁止使用具体的法规（文档标题）、标准、图名、表名或文件名称。
   - 答案需覆盖Reference中回答问题所需的所有核心信息点
   - 评分：0/1（不合格/合格）

2. 技术性（technical）:
   - 问题需涉及技术参数、适用条件或推导过程
   - 评分：0/1

3. 知识性（knowledge）:
   - 问题需涉及原理分析、策略或作用阐释
   - 评分：0/1

4. 准确性（correctness）:
   - 答案需严格基于Reference内容，无添加或虚构
   - 问题和答案的主语无模糊的指代型词汇，如‘本文’，‘本规范’。
   - 评分：0/1

5. 幻觉检测（hallucination）:
   - 答案中每句事实陈述必须能被Reference直接支持
   - 评分：0/1（存在任意幻觉即0分）

6. 难度（difficulty）:
   - 根据问题复杂度和所需推理深度评分（1-5分）
   - 若答案可直接从问题(并非REF)中推导则计0分


返回格式（JSON）：
{{
    "reason": "简要综述优缺点，问题分类依据，重点说明主语完整性、覆盖率及幻觉问题",
    "completeness": 0,
    "technical": 0,
    "knowledge": 0,
    "correctness": 0,
    "hallucination": 0,
    "difficulty": 0,
}}

输入：
{QA_pair}
"""

turn_3_prompt = """
**角色设定**
你是一个政策文件解读问题设计专家，擅长从政策文本中提炼关键信息并设计多轮递进式提问。

**任务目标**
基于提供的政策类文件，生成一组三轮递进式对话问题，用于帮助人们逐步深入理解政策的内容与应用。
三轮提问必须保证能从文中正确回答，如果有一个问题无法从文中正确回答会导致整个多轮提问失败，请谨慎提问。

**生成规则**

1. **轮次结构**

   * **第一轮**：围绕文件中的**基础概念、核心定义或适用范围**提问。多为概念型的问题。
   * **第二轮**：结合一个**合理的具体情景**，围绕文件中可能的**执行规范、操作要求或违规后果**（前提是文件中存在）提问，问题必须承接第一轮的主题。多为场景型的问题。
   * **第三轮**：在前两轮情境的基础上，延伸至文件可能的**长效管理、实际挑战或与其他机制的衔接**（前提是文件中存在）提问。

2. **逻辑要求**

   * 问题必须**递进**，后一轮的问题需要与前一轮的问题保持主题连续。可以从前一轮的答案中继续追问。
   * 不能出现与文件无关的情景或假设。要求问题的答案皆能从原文中得到。
   * 不得附加答案或解释。

3. **语言风格**

   * 用中文提问，句式清晰、专业、简洁。
   * 单个问题可由 1–2 句组成，不超过 60 个字，但可适当使用括号补充细节。
   * 要求生成的三轮问答对总字数超过600字，因此问题不能过于简单。

4. **输出格式（严格遵守轮数顺序）**

```
<Q>[第一轮问题]</Q>
<A>[第一轮回答]</A>
<Q>[第二轮问题]</Q>
<A>[第二轮回答]</A>
<Q>[第三轮问题]</Q>
<A>[第三轮回答]</A>
```

**示例**

```
<Q>《上海市民办养老机构消防安全达标提升工程实施方案》中，民办养老机构在改造时，建筑消防安全及消防设施设备需符合哪些具体的标准规范？</Q>
<A>建筑环境及消防设施配置要严格执行《建筑设计防火规范》（GB50016）、《建筑灭火器配置设计规范》（GB50140）、《火灾自动报警系统设计规范》（GB50116）、《建筑防烟排烟系统技术标准》（GB51251）等相关标准规范。同时，改造涉及的房屋建筑需有功能变更批准文件、不动产登记或使用权证明（含所在街道、乡镇对养老服务设施现状的书面认可证明）；租赁房屋开办的机构，需事先取得产权所有方书面认可。</A>
<Q>如果某民办养老机构在 2021 年 9 月底工程实施阶段结束后，仍未完成消防安全改造且未达标，根据方案要求会如何处理？</Q>
<A>方案明确，对确实难以改造到位的民办养老机构，各区民政局应结合实际予以撤销，确保到 2021 年底前辖区所有民办养老机构的消防设施设备配备符合标准，坚决杜绝各类消防安全隐患。因此，若该机构属于难以改造到位的情况，可能会被撤销。</A>
<Q>结合方案中“实效评估”阶段的要求，若已验收的民办养老机构后续因管理疏漏导致消防设施失效引发安全问题，方案中的“长效管理机制”（如随机检查、第三方体检式检查）能如何预防与补救？</Q>
<A>方案通过多方面保障监督实效：一是明确协调沟通机制需定期会商研究消防安全管理情况、协调解决问题、确定重点工作并按期督办；二是随机检查和飞行检查由市民政局联合市消防救援总队开展，发现问题及时通报并督促整改；三是第三方 “体检式” 检查由各区民政局通过购买服务委托专业机构进行，检查出的隐患会纳入整改清单，形成闭环管理；同时，整个过程中各区联合工作组全程监管，问题需及时处理和上报，多重机制共同保障监督落地。<A>
```

```
<Q>高层民用建筑的消防安全由谁负责？</Q>
<A>根据《规定》第四条，业主和使用人是直接责任主体。如果是单位，则其法定代表人或主要负责人为消防安全责任人。他们可以委托物业或消防服务机构管理，但需在合同中明确服务内容。</A>
<Q>如果业主委托物业公司管理消防，物业具体要做哪些工作？</Q>
<A>第十条指出，物业必须：定期检测维护消防设施；巡查并消除火灾隐患（如堵塞通道）；制止违规行为（如电动自行车进楼道）；组织消防演练和宣传。若发现问题需及时报告消防救援机构。</A>
<Q>如果物业发现住户在楼梯间停电动自行车，但住户拒不改正，该怎么办？</Q>
<A>根据第三十七条和第四十七条：物业应先劝阻并督促整改；若无效，需向消防救援机构报告；违规者将面临500-1000元（个人）或2000-10000元（单位）罚款。同时，物业应引导住户使用集中充电设施。</A>
```


原文：
{content}
"""

turn_3_question_answer_prompt = """
筛选所提供问题，确认是否能在具体条款章节中找到答案，问题本身是否符合原文。
若符合条件，请按照返回格式返回。要求COT部分先列出论据所在的具体的条款章节再进行分析，给出具体条款章节和涉及的原文细节，禁用“原文”、 “文中”等模糊不清的说法；
在COT和回答中一律禁用“原文”、 “文中”等模糊不清的说法。
知识性材料要求逻辑推导能力，回答内容适度自由，需要思维链，可以进行总结提炼。

回答要求（符合筛选标准的问题）
1. **COT（思维链）要求**：  
   a. 定位 (Locate)：通过分析，确定问题答案所对应的精确条款章节位置（例如：“第四章第二十二条”）。
   b. 摘录与引用 (Quote & Cite)：立即、完整地摘录该章节中与问题相关的全部原文内容。
   - 【强制性规定】：在摘录内容的结尾（最后一个句号、分号或短语后），必须毫不例外地、立即标注引用来源 {{ref_i}}。任何形式的省略、遗漏或延迟标注都是不可接受的错误。
   - 摘录时必须保证原文的完整性，禁止任何形式的简写、概括或转述。
   c. 禁用语 (Banned Phrases)：在整个响应中，绝对禁止使用“原文所述”、“文中提到”、“根据规定”等模糊表述。只能直接呈现章节位置、原文内容和引用标记。

   - 示例 (Examples)
   符合要求的响应：
   “...相关内容为：‘国家实行网络安全等级保护制度。网络运营者应当按照网络安全等级保护制度的要求，履行下列安全保护义务...’{{ref_1}}”
   严重错误的响应（遗漏引用）：
   “...相关内容为：‘国家实行网络安全等级保护制度。网络运营者应当按照网络安全等级保护制度的要求，履行下列安全保护义务...’”
   → 上述响应因缺少 {{ref_i}} 而被视为完全失败。  

2. **Answer要求**：  
   - 需完整列出COT中引用的原文内容（禁止【FORBIDDEN】出现{{ref_i}}，“Reference”“ref”等字样）；  
   - 如果允许，答案中必须明确写出参考的法规、标准、图名、表名或文件名称。
   - 根据原文内容辅助逻辑推导能力，回答问题，内容适度自由，需要思维链，可以进行总结提炼,不能过于精炼。

返回格式：问题被<Q></Q>包裹(保证问题完整，不要缺失选项)，答案被<A></A>包裹，思维链被<COT></COT>包裹
<Q>Question</Q>
<COT>Chain of Thought</COT>
<A>Answer</A>

[IMPORTANT]:问题**必须**被<Q></Q>包裹(保证问题完整，不要缺失选项)，答案被<A></A>包裹，思维链被<COT></COT>包裹

待筛选问题：
{question}

原文：
{content}
"""

turn_2_prompt =  """
**角色设定**
你是一个政策文件解读问题设计专家，擅长从政策文本中提炼关键信息并设计多轮递进式提问。

**任务目标**
基于提供的政策类文件，生成一组两轮递进式对话问题，用于帮助人们逐步深入理解政策的内容与应用。
两轮提问必须保证能从文中正确回答，如果有一个问题无法从文中正确回答会导致整个多轮提问失败，请谨慎提问。

**生成规则**

1. **轮次结构**

   * **第一轮**：围绕文件中的**基础概念、核心定义或适用范围**提问。多为概念型的问题。
   * **第二轮**：结合一个**合理的具体情景**，围绕文件中可能的**执行规范、操作要求或违规后果**（前提是文件中存在）提问，问题必须承接第一轮的主题。必须为场景型的问题。

2. **逻辑要求**

   * 问题必须**递进**，后一轮的问题需要与前一轮的问题保持主题连续。可以从前一轮的答案中继续追问。
   * 问题中**禁止**使用任何具体的法规、标准、图名、表名或文件名称。无需出现 ‘根据规范’ 等表述。
   * 不能出现与文件无关的情景或假设。要求问题的答案皆能从原文中得到。
   * 不得附加答案或解释。

3. **语言风格**

   * 用中文提问，句式清晰、专业、简洁。
   * 单个问题可由 1–2 句组成，不超过 60 个字，但可适当使用括号补充细节。
   * 要求生成的两轮问答对总字数超过400字，因此问题不能过于简单, 第二轮场景题难度限定在2-3个知识点。

4. **输出格式（严格遵守轮数顺序）**

```
<Q>[第一轮问题]</Q>
<A>[第一轮回答]</A>
<Q>[第二轮问题]</Q>
<A>[第二轮回答]</A>
```

**示例**

```
<Q>如何定义“轰燃”（flashover）？其与“闪燃”（flash）有何本质区别？</Q>
<A>根据标准第2.30条，“轰燃”指某一空间内所有可燃物表面瞬间全面卷入燃烧的瞬变过程，是火灾从局部向全局发展的临界现象。而“闪燃”（2.29）是可燃液体蒸气或固体表层遇明火发生一闪即灭的燃烧，本质是短暂气相燃烧现象。两者区别在于：轰燃是全局性、持续性的燃烧状态突变，闪燃是局部、瞬时的点火现象。</A>
<Q>某化工仓库存储易燃液体，通风不良且无自动抑爆系统。现场发生泄漏后，蒸气遇静电火花引发闪燃，随后火焰蔓延至货架堆积的可燃包装材料。此场景中可能依次发生哪些火灾现象？需优先采用哪类灭火系统？</Q>
<A>可能依次发生闪燃（蒸气遇火花）、阴燃（包装材料缓慢燃烧）、轰燃（全局燃烧）。需优先采用局部应用灭火系统（2.66），直接喷射灭火剂至泄漏源和货架区域，抑制火焰蔓延。同时需加强通风和惰化（2.40）处理，避免形成爆炸性环境。</A>
```


原文：
{content}
"""