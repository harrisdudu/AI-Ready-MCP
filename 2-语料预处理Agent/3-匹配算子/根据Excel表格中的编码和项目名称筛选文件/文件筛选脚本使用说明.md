# 文件筛选脚本使用说明

## 脚本功能

这个脚本可以根据Excel表格中的编码和项目名称，在指定的目录中筛选匹配的文件，并将它们复制到新的文件夹中。

## 文件说明

- `文件筛选脚本.py` - 图形界面版本（推荐使用）
- `文件筛选脚本_命令行版.py` - 命令行版本

## 使用前准备

### 1. 安装必要的Python库

在运行脚本前，请确保安装了以下Python库：

```bash
pip install pandas openpyxl tkinter
```

### 2. Excel表格格式要求

Excel表格需要包含以下列（至少包含其中一组）：
- `编码` 和 `项目名称`
- `编号` 和 `名称`

示例Excel表格格式：

| 编码 | 项目名称 |
|------|----------|
| 001  | 项目A    |
| 002  | 项目B    |
| 003  | 项目C    |

## 使用方法

### 方法一：图形界面版本（推荐）

1. 双击运行 `文件筛选脚本.py`
2. 在界面中依次选择：
   - **目标目录**：需要筛选的文件所在的目录
   - **新文件夹路径**：筛选结果要保存的目录
   - **Excel表格**：包含编码和项目名称的Excel文件
3. 点击"开始筛选"按钮
4. 等待筛选完成

### 方法二：命令行版本

```bash
# 基本用法
python "文件筛选脚本_命令行版.py" --source "目标目录路径" --target "新文件夹路径" --excel "Excel文件路径"

# 简写参数
python "文件筛选脚本_命令行版.py" -s "目标目录路径" -t "新文件夹路径" -e "Excel文件路径"

# 示例
python "文件筛选脚本_命令行版.py" -s "C:\\项目文件" -t "C:\\筛选结果" -e "C:\\项目列表.xlsx"
```

## 筛选规则

脚本会按照以下规则进行文件匹配：

1. **文件名匹配**：检查文件名（不含扩展名）是否包含Excel中的编码或项目名称
2. **部分匹配**：只要文件名中包含编码或项目名称的任何部分，就会被匹配
3. **递归搜索**：会搜索目标目录及其所有子目录
4. **避免重复**：如果目标文件夹中已有同名文件，会自动添加序号避免覆盖

## 示例场景

假设你有以下文件结构：

```
项目文件/
├── 001_项目A_报告.docx
├── 002_项目B_计划.xlsx
├── 003_项目C_总结.pdf
└── 其他文件.txt
```

Excel表格内容：

| 编码 | 项目名称 |
|------|----------|
| 001  | 项目A    |
| 003  | 项目C    |

筛选结果：

```
筛选结果/
├── 001_项目A_报告.docx
└── 003_项目C_总结.pdf
```

## 注意事项

1. **文件编码**：确保Excel文件和文件名使用正确的编码（推荐UTF-8）
2. **文件权限**：确保有读取源文件和写入目标文件夹的权限
3. **文件大小**：大文件复制可能需要较长时间
4. **Excel格式**：支持.xlsx和.xls格式的Excel文件
5. **错误处理**：脚本会显示详细的错误信息，便于排查问题

## 故障排除

### 常见问题

1. **"读取Excel文件失败"**
   - 检查Excel文件路径是否正确
   - 确认Excel文件没有被其他程序占用
   - 检查Excel文件格式是否支持

2. **"未找到匹配的文件"**
   - 确认目标目录中有文件
   - 检查Excel中的编码/名称与文件名是否匹配
   - 尝试使用部分匹配（如文件名包含编码即可）

3. **"复制文件失败"**
   - 检查目标文件夹是否有写入权限
   - 确认源文件没有被占用
   - 检查磁盘空间是否充足

### 技术支持

如果遇到问题，请检查：
- Python版本（推荐Python 3.6+）
- 依赖库是否安装正确
- 文件路径是否包含特殊字符
- 系统权限设置

## 更新日志

- v1.0 (2024) - 初始版本发布
  - 图形界面和命令行版本
  - 支持Excel表格读取
  - 文件匹配和复制功能
  - 错误处理和进度显示